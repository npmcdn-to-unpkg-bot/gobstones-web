{"version":3,"sources":["scripts/stylist.js"],"names":[],"mappings":"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","file":"scripts/stylist.js","sourcesContent":["class Stylist {\n  constructor() {\n    this.DEFAULT_PERCENTAGE = 0.6;\n    this.TOOLBAR_HEIGHT = 64;\n    this.TOOLBAR_AND_SIZE_SELECTOR_HEIGHT = this.TOOLBAR_HEIGHT + 38;\n    this.CELL_SIZE = 59;\n    this.BOARD_CSS_CLASS = \".theBoard\";\n    this.BOARD_CONTAINER_CSS_CLASS = \".theBoardContainer\";\n    this.BOARD_CONTAINER_OFFSET = 8;\n    this.BOARD_CONTAINER_VERTICAL_MARGIN = 20;\n    this.LEFT_PANEL_CSS_CLASS = \".panel-left\";\n  }\n\n  correctEditorHeight(editor) {\n    const fixHeight = () => {\n      const lineHeight = editor.renderer.lineHeight;\n\n      const availableLines = ($(document).height() - this.TOOLBAR_HEIGHT) / editor.renderer.lineHeight;\n      console.log(\"availableLines\", availableLines);\n      editor.setOption(\"minLines\", availableLines);\n      editor.setOption(\"maxLines\", availableLines);\n    }\n\n    setTimeout(fixHeight);\n    $(window).resize(fixHeight);\n  }\n\n  setPanelAsResizable(boardDimensions) {\n    $(document).ready(() => {\n      this._makeResizable();\n      setTimeout(() => {\n        $(`${this.LEFT_PANEL_CSS_CLASS} .ui-resizable-s`).hide();\n        $(`${this.LEFT_PANEL_CSS_CLASS} .ui-resizable-se`).hide();\n\n        this.updateBoardSize(boardDimensions);\n      }, 0);\n    });\n\n    $(window).resize(() => {\n      this._beResponsive();\n    });\n  }\n\n  updateBoardSize(boardDimensions) {\n    this._saveBoardSize(boardDimensions);\n    this._beResponsive();\n  }\n\n  _beResponsive() {\n    var percentage = this._keepAspectRatioOnWindowResize(this.LEFT_PANEL_CSS_CLASS);\n    this._scaleAndCenterBoard(percentage);\n  }\n\n  _keepAspectRatioOnWindowResize() {\n    const documentWidth = $(document).width()\n    if (!this.lastDocumentWidth) {\n      this.lastDocumentWidth = documentWidth;\n      return this.DEFAULT_PERCENTAGE;\n    }\n\n    const percentage = this._getPercentage();\n\n    const leftPanel = $(this.LEFT_PANEL_CSS_CLASS);\n    leftPanel.width(documentWidth * percentage);\n    this.lastDocumentWidth = documentWidth;\n\n    return percentage;\n  }\n\n  _scaleAndCenterBoard(percentage) {\n    const scale = this._getScale(percentage);\n    $(this.BOARD_CSS_CLASS).css(\"transform\", `scale(${scale})`);\n    this._centerBoard(percentage, scale);\n  }\n\n  _centerBoard(percentage, scale) {\n    // center vertically\n    const middleY = (this._getRightPanelHeight()) / 2;\n    const offsetY = this.currentBoardHeight / 2;\n    $(this.BOARD_CSS_CLASS).css(\"margin-top\", `${middleY - offsetY}px`);\n\n    // center horizontally\n    $(\".theBoardContainer\").width(0); // avoid increasing container width\n    const panelWidth = this._getRightPanelWidth(percentage);\n    const middleX = panelWidth / 2;\n    const microMarginFix = - (-0.000975862 * this.boardDimensions.x + 0.131475862) * this.CELL_SIZE * scale;\n    const offsetX = this.BOARD_CONTAINER_OFFSET + (this.currentBoardWidth * scale) / 2 + microMarginFix;\n\n    $(this.BOARD_CONTAINER_CSS_CLASS).css(\"margin-left\", `${middleX - offsetX}px`);\n  }\n\n  _makeResizable() {\n    $(this.LEFT_PANEL_CSS_CLASS).resizable({\n      resizeHeight: false\n    });\n  }\n\n  _saveBoardSize(boardDimensions) {\n    const boardSize = this._getBoardSize(boardDimensions);\n    this.currentBoardWidth = boardSize.width;\n    this.currentBoardHeight = boardSize.height;\n    this.boardDimensions = boardDimensions;\n  }\n\n  _getBoardSize(boardDimensions) {\n    return {\n      width: 39 + boardDimensions.x * this.CELL_SIZE,\n      height: 39 + boardDimensions.y * this.CELL_SIZE\n    };\n  }\n\n  _getPercentage() {\n    const leftPanel = $(this.LEFT_PANEL_CSS_CLASS);\n    return leftPanel.width() / this.lastDocumentWidth;\n  }\n\n  _getRightPanelWidth(percentage) {\n    return $(document).width() * (1 - percentage);\n  }\n\n  _getRightPanelHeight() {\n    return $(document).height() - this.TOOLBAR_AND_SIZE_SELECTOR_HEIGHT - this.BOARD_CONTAINER_VERTICAL_MARGIN;\n  }\n\n  _getScale(percentage) {\n    const panelWidth = this._getRightPanelWidth(percentage);\n    const scaleX = panelWidth / this.currentBoardWidth;\n\n    const panelHeight = this._getRightPanelHeight();\n    const scaleY = panelHeight / this.currentBoardHeight;\n\n    return Math.min(scaleX, scaleY)\n  }\n}\n"],"sourceRoot":"/source/"}